# Your NutritionBro
Course Project for Deep Learning. Input a food image and then print out ingredient list and nutrition list.    

Mengxi Wu mw4355@nyu.edu  
Qi Yin qy652@nyu.edu    

Professor: Chinmay Hegde        

#### What is it?

***

Food is essential for our lives!   
If you want to know your food better you can just take a photo of  the it and submit to your Your Nutrition Bro.
It will automatically process your image and prints out ingredients list as well as nutrition set. 

![image-20201215225008725](https://github.com/yq605879396/Your-NutritionBro/blob/main/images/show1.png)![image-20201215225113414](https://github.com/yq605879396/Your-NutritionBro/blob/main/images/show2.png)![image-20201215225136866](https://github.com/yq605879396/Your-NutritionBro/blob/main/images/show3.png)
_credit to "ins:etn.co_mam"_

#### File Structure

***

**./data:**  
Folder "data" has the text information from dataset [ingredient101](http://www.ub.edu/cvub/ingredients101/) and [Recipe5k](https://www.kaggle.com/kmader/food41).   
But it doesn't contains image. You can download corresponding images [food101](https://www.kaggle.com/kmader/food41) and [Recipe5k](https://www.kaggle.com/kmader/food41)

**./test_img:**  
We saved several test image under the folder of test_img, you can also add your own image.     

**./nutribro_model **   
Contains the files for model.        

**./suply**  
saved some useful code: default parameters, vocabulary builder, data loader, dataset sampler and some helper functions.  

**root**:  
train: train the model  
test: test the model  
test.ipynb: test the model, will process the image in test_img folder, and print ingredients list and nutrition list.  

Result for the preprocess:  can be regenerated by running suply/build_vocab  
datatest.pkl/ datatrain.pkl / dataval.pkl: processed data, needed when training the model  
vocab_ingrs.pkl: generated vocabulary: needed when training or testing the model  

#### How to use it?

***

###### To train the model:  
In root directory, run : python train.py (you can add you config here or just modify suply/args.py)

Or you can download pretrained model here:  
[Res18 + 6 epoch](http://www.ub.edu/cvub/ingredients101/)  
[Res18 + 12 epoch](http://www.ub.edu/cvub/ingredients101/)  
[Res150 + 6 epoch](http://www.ub.edu/cvub/ingredients101/)  

###### To Test the model:  
You can run test.ipynb  
Or at root directory run: python test  

#### Reference

***

